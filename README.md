# HTML to Markdown 浏览器插件

一个将网页内容转换为Markdown格式并保存为文件的浏览器扩展。

## 功能特性

- 将网页HTML内容转换为Markdown格式
- 支持移除沉浸式翻译等翻译插件添加的内容
- 支持保留或移除链接
- 支持通过CSS选择器指定要转换的特定区域
- 自动下载转换后的Markdown文件
- 自动下载页面中的图片
- **自动采集功能**：从左侧菜单树自动遍历并采集多个页面
- **快捷键支持**：Alt+Q 转换当前页面，Alt+W 启动/停止自动采集
- **图片去重**：同一图片在多个页面使用时只下载一次
- **GIF文件支持**：GIF文件保持原始格式，不转换为PNG

## 安装方法

### Chrome/Edge 浏览器

1. 下载或克隆此项目到本地
2. 打开浏览器，访问 `chrome://extensions/` (Chrome) 或 `edge://extensions/` (Edge)
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择此项目的文件夹
6. 插件安装完成

## 使用方法

### 单页转换

1. 打开要转换的网页
2. 点击浏览器工具栏中的插件图标
3. 在弹出的窗口中配置选项：
   - **包含翻译内容**：勾选后会保留沉浸式翻译等插件添加的翻译元素
   - **保留链接**：勾选后会保留Markdown中的链接格式
   - **CSS选择器**：可选，输入CSS选择器来指定要转换的特定区域（如 `.content`、`#main`），留空则转换整个页面
   - **保存路径**：设置Markdown和图片文件的保存路径
4. 点击"转换为Markdown"按钮或使用快捷键 `Alt+Q`
5. 转换完成后，Markdown文件和图片会自动下载

### 自动采集功能

1. 打开包含左侧菜单树的网页
2. 在左侧菜单树中选择要开始采集的菜单项
3. 点击插件图标，配置保存路径和等待时间
4. 点击"自动采集"按钮或使用快捷键 `Alt+W`
5. 插件会自动执行以下操作：
   - 滚动到页面底部
   - 等待指定时间（默认10秒）让翻译插件加载完成
   - 转换当前页面为Markdown并下载
   - 自动点击下一个菜单项
   - 重复上述步骤直到所有页面处理完成
6. 如需停止，再次点击"自动采集"按钮或使用快捷键 `Alt+W`

### 配置选项

- **保存路径**：设置Markdown和图片文件的保存路径（如 `/docs/foundry/`）
- **自动采集等待时间(秒)**：设置自动采集时等待翻译插件加载的时间（1-60秒，默认10秒）
- 所有配置会自动保存，下次使用时自动加载

## 快捷键

- `Alt + Q`：触发"转换为Markdown"按钮
- `Alt + W`：触发"自动采集"按钮（启动或停止）

## 支持的HTML元素

插件支持将以下HTML元素转换为Markdown：

- 标题：`h1`-`h6` → `#`-`######`
- 段落：`p` → 普通文本
- 强调：`strong`、`b` → `**text**`
- 斜体：`em`、`i` → `*text*`
- 代码：`code` → `` `code` ``
- 代码块：`pre` → ```code```
- 链接：`a` → `[text](url)`
- 列表：`ul`、`ol` → `- item` 或 `1. item`
- 引用：`blockquote` → `> text`
- 分隔线：`hr` → `---`
- 图片：`img` → `![alt](src)`
- 表格：`table` → Markdown表格格式

## 文件结构

```
tomarkdown/
├── manifest.json          # 插件配置文件
├── popup.html             # 弹出页面HTML
├── popup.css              # 弹出顶面样式
├── popup.js               # 弹出页面逻辑
├── content.js             # 内容脚本（HTML转Markdown）
└── README.md              # 说明文档
```

## 注意事项

- 如果插件无法正常工作，请尝试刷新页面后重试
- 某些网站可能有内容安全策略（CSP）限制，可能影响插件功能
- 转换后的Markdown文件名基于网页URL路径，会自动清理特殊字符
- 自动采集功能需要页面包含可识别的菜单树结构
- GIF文件会保持原始格式，不会转换为PNG
- 同一图片在多个页面使用时只会下载一次

## 开发

如需修改插件，编辑相应文件后：

1. 在 `chrome://extensions/` 页面找到此插件
2. 点击刷新按钮
3. 重新加载要测试的网页

## 许可证

MIT License
